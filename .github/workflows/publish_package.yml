name: Publish cookietemple to PyPI

on:
  release:
    types: [created]

jobs:
  deploy:
    runs-on: ubuntu-latest
    if: "!contains(github.event.head_commit.message, '[skip ci]') && !contains(github.event.head_commit.message, '[ci skip]')"
    steps:
    - uses: actions/checkout@v2
      name: Check out source-code repository

    - name: Set up Python
      uses: actions/setup-python@v2.2.2
      with:
        python-version: '3.8'

            - name: Install Poetry
              run: |
                  pip install poetry
                  poetry --version

            - name: Build package
              run: |
                  poetry build --ansi

            - name: Publish package on PyPI
              uses: pypa/gh-action-pypi-publish@v1.4.2
              with:
                  user: ${{ secrets.PYPI_USERNAME }}
                  password: ${{ secrets.PYPI_PASSWORD }}

